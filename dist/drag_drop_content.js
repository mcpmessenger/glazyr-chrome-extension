(()=>{"use strict";console.log("Glazyr Drag and Drop Content Script injected."),document.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()},!1),document.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation()},!1),document.addEventListener("drop",function(e){if(e.preventDefault(),e.stopPropagation(),e.dataTransfer&&e.dataTransfer.files.length>0){const r=e.dataTransfer.files[0];if(r.type.startsWith("image/")){console.log("Image file dropped:",r.name);const e=new FileReader;e.onload=e=>{const t=e.target?.result;chrome.runtime.sendMessage({type:"IMAGE_FOR_ANALYSIS",source:"drag_drop",dataUrl:t,mimeType:r.type},e=>{chrome.runtime.lastError?console.error("Error sending image for analysis:",chrome.runtime.lastError.message):(console.log("Image data sent to background:",e),alert(`Glazyr received image: ${r.name}. Sending to AI for analysis...`))})},e.readAsDataURL(r)}else console.log("Dropped file is not an image:",r.type)}else if(e.dataTransfer&&e.dataTransfer.getData("text/html")){const r=e.dataTransfer.getData("text/html"),t=document.createElement("div");t.innerHTML=r;const a=t.querySelector("img");a&&a.src&&(console.log("Image element dragged:",a.src),chrome.runtime.sendMessage({type:"IMAGE_FOR_ANALYSIS",source:"drag_element",imageUrl:a.src},e=>{chrome.runtime.lastError?console.error("Error sending image URL for analysis:",chrome.runtime.lastError.message):(console.log("Image URL sent to background:",e),alert(`Glazyr received image URL: ${a.src}. Sending to AI for analysis...`))}))}},!1),chrome.runtime.onMessage.addListener((e,r,t)=>{if("START_CROP_CAPTURE"===e.type)return console.log("Starting crop capture UI..."),alert("Glazyr Crop Capture: Selection mode activated. (Simulated)"),setTimeout(()=>{chrome.runtime.sendMessage({type:"IMAGE_FOR_ANALYSIS",source:"crop_capture",dataUrl:"MOCK_CROPPED_IMAGE_DATA_URL"}),console.log("Mock cropped image data sent for analysis.")},1e3),t({status:"Crop capture initiated"}),!0})})();